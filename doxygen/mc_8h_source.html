<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>mcpele: mcpele/mc.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://www.mathjax.org/mathjax/MathJax.js"></script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">mcpele
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">The Monte Carlo Python Energy Landscape Explorer</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>&#160;</span></a></li>
      <li><a href="https://pele-python.github.io/mcpele/"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">mcpele/mc.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef _MCPELE_MC_H</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define _MCPELE_MC_H</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;cmath&gt;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;algorithm&gt;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;memory&gt;</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;stdexcept&gt;</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="preprocessor">#include &quot;pele/array.h&quot;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &quot;pele/base_potential.h&quot;</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="keyword">namespace </span>mcpele{
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="keyword">class </span>MC;
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="comment">/*</span>
<a name="l00017"></a>00017 <span class="comment"> * Action</span>
<a name="l00018"></a>00018 <span class="comment"> */</span>
<a name="l00019"></a>00019 
<a name="l00020"></a><a class="code" href="classmcpele_1_1Action.html">00020</a> <span class="keyword">class </span><a class="code" href="classmcpele_1_1Action.html">Action</a> {
<a name="l00021"></a>00021 <span class="keyword">public</span>:
<a name="l00022"></a>00022     <span class="comment">//Action(){std::cout&lt;&lt; &quot;Action()&quot; &lt;&lt;  &quot;\n&quot;;}</span>
<a name="l00023"></a>00023     <span class="comment">//virtual ~Action(){std::cout &lt;&lt; &quot;~Action()&quot; &lt;&lt;  &quot;\n&quot;;}</span>
<a name="l00024"></a><a class="code" href="classmcpele_1_1Action.html#adee26930d409e327d88b8539b5bb3a67">00024</a>     <span class="keyword">virtual</span> <a class="code" href="classmcpele_1_1Action.html#adee26930d409e327d88b8539b5bb3a67">~Action</a>(){}
<a name="l00025"></a>00025     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1Action.html#a9500d60c55f0d36ffb6ed0464ea3c68e">action</a>(<a class="code" href="classpele_1_1Array.html">pele::Array&lt;double&gt;</a> &amp;coords, <span class="keywordtype">double</span> energy, <span class="keywordtype">bool</span> accepted,
<a name="l00026"></a>00026             <a class="code" href="classmcpele_1_1MC.html">MC</a>* mc) =0;
<a name="l00027"></a>00027 };
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="comment">/*</span>
<a name="l00030"></a>00030 <span class="comment"> * Accept Test</span>
<a name="l00031"></a>00031 <span class="comment"> */</span>
<a name="l00032"></a>00032 
<a name="l00033"></a><a class="code" href="classmcpele_1_1AcceptTest.html">00033</a> <span class="keyword">class </span><a class="code" href="classmcpele_1_1AcceptTest.html">AcceptTest</a>{
<a name="l00034"></a>00034 <span class="keyword">public</span>:
<a name="l00035"></a>00035     <span class="comment">//AcceptTest(){std::cout &lt;&lt; &quot;AcceptTest()&quot; &lt;&lt;  &quot;\n&quot;;}</span>
<a name="l00036"></a>00036     <span class="comment">//virtual ~AcceptTest(){std::cout &lt;&lt; &quot;~AcceptTest()&quot; &lt;&lt;  &quot;\n&quot;;}</span>
<a name="l00037"></a><a class="code" href="classmcpele_1_1AcceptTest.html#ab2a9fd77376ce15e1c7c5b1ee0df23fc">00037</a>     <span class="keyword">virtual</span> <a class="code" href="classmcpele_1_1AcceptTest.html#ab2a9fd77376ce15e1c7c5b1ee0df23fc">~AcceptTest</a>(){}
<a name="l00038"></a>00038     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classmcpele_1_1AcceptTest.html#ae2d9e2feaae60d49a35c7170f56f5d78">test</a>(<a class="code" href="classpele_1_1Array.html">pele::Array&lt;double&gt;</a> &amp;trial_coords, <span class="keywordtype">double</span> trial_energy,
<a name="l00039"></a>00039             <a class="code" href="classpele_1_1Array.html">pele::Array&lt;double&gt;</a> &amp; old_coords, <span class="keywordtype">double</span> old_energy, <span class="keywordtype">double</span> temperature,
<a name="l00040"></a>00040             <a class="code" href="classmcpele_1_1MC.html">MC</a> * mc) =0;
<a name="l00041"></a>00041 };
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="comment">/*</span>
<a name="l00044"></a>00044 <span class="comment"> * Accept Test</span>
<a name="l00045"></a>00045 <span class="comment"> */</span>
<a name="l00046"></a>00046 
<a name="l00047"></a><a class="code" href="classmcpele_1_1ConfTest.html">00047</a> <span class="keyword">class </span><a class="code" href="classmcpele_1_1ConfTest.html">ConfTest</a>{
<a name="l00048"></a>00048 <span class="keyword">public</span>:
<a name="l00049"></a>00049     <span class="comment">//ConfTest(){std::cout &lt;&lt; &quot;ConfTest()&quot; &lt;&lt;  &quot;\n&quot;;}</span>
<a name="l00050"></a>00050     <span class="comment">//virtual ~ConfTest(){std::cout &lt;&lt; &quot;~ConfTest()&quot; &lt;&lt;  &quot;\n&quot;;}</span>
<a name="l00051"></a><a class="code" href="classmcpele_1_1ConfTest.html#a8d5a5ff5d0222a2d55e3e6c413559d2a">00051</a>     <span class="keyword">virtual</span> <a class="code" href="classmcpele_1_1ConfTest.html#a8d5a5ff5d0222a2d55e3e6c413559d2a">~ConfTest</a>(){}
<a name="l00052"></a>00052     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classmcpele_1_1ConfTest.html#ad2757dd936a04849c9657e15a950dd8f">conf_test</a>(<a class="code" href="classpele_1_1Array.html">pele::Array&lt;double&gt;</a> &amp;trial_coords, <a class="code" href="classmcpele_1_1MC.html">MC</a> * mc) =0;
<a name="l00053"></a>00053 };
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="comment">/*</span>
<a name="l00056"></a>00056 <span class="comment"> * Take Step</span>
<a name="l00057"></a>00057 <span class="comment"> */</span>
<a name="l00058"></a>00058 
<a name="l00059"></a><a class="code" href="classmcpele_1_1TakeStep.html">00059</a> <span class="keyword">class </span><a class="code" href="classmcpele_1_1TakeStep.html">TakeStep</a> {
<a name="l00060"></a>00060 <span class="keyword">public</span>:
<a name="l00061"></a><a class="code" href="classmcpele_1_1TakeStep.html#a82aab5c2527f8a7fd4c0f8a438dc3625">00061</a>     <span class="keyword">virtual</span> <a class="code" href="classmcpele_1_1TakeStep.html#a82aab5c2527f8a7fd4c0f8a438dc3625">~TakeStep</a>() {}
<a name="l00062"></a>00062     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1TakeStep.html#ac3032e0d99d4aa5f940ffea4a28442f5">displace</a>(<a class="code" href="classpele_1_1Array.html">pele::Array&lt;double&gt;</a>&amp; coords, <a class="code" href="classmcpele_1_1MC.html">MC</a>* mc) = 0;
<a name="l00063"></a><a class="code" href="classmcpele_1_1TakeStep.html#aac4f30de62c4cbc4d9d31c7629742f64">00063</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1TakeStep.html#aac4f30de62c4cbc4d9d31c7629742f64">report</a>(<a class="code" href="classpele_1_1Array.html">pele::Array&lt;double&gt;</a>&amp;, <span class="keyword">const</span> <span class="keywordtype">double</span>,
<a name="l00064"></a>00064             <a class="code" href="classpele_1_1Array.html">pele::Array&lt;double&gt;</a>&amp;, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">bool</span>, <a class="code" href="classmcpele_1_1MC.html">MC</a>*) {}
<a name="l00065"></a><a class="code" href="classmcpele_1_1TakeStep.html#afa92f5196e0304d6ad910304b188c705">00065</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1TakeStep.html#afa92f5196e0304d6ad910304b188c705">increase_acceptance</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>) {}
<a name="l00066"></a><a class="code" href="classmcpele_1_1TakeStep.html#a492ccf2a2e3b3d8ef2224947d0385d77">00066</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1TakeStep.html#a492ccf2a2e3b3d8ef2224947d0385d77">decrease_acceptance</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>) {}
<a name="l00067"></a>00067 };
<a name="l00068"></a>00068 
<a name="l00083"></a><a class="code" href="classmcpele_1_1MC.html">00083</a> <span class="keyword">class </span><a class="code" href="classmcpele_1_1MC.html">MC</a> {
<a name="l00084"></a>00084 <span class="keyword">public</span>:
<a name="l00085"></a><a class="code" href="classmcpele_1_1MC.html#a6b0a924bb76c28b6fc25c66675c1dcf9">00085</a>     <span class="keyword">typedef</span> std::vector&lt;std::shared_ptr&lt;Action&gt; &gt; <a class="code" href="classmcpele_1_1MC.html#a6b0a924bb76c28b6fc25c66675c1dcf9">actions_t</a>;
<a name="l00086"></a><a class="code" href="classmcpele_1_1MC.html#ab52ae82dba8e7299583f48a382f8bd5a">00086</a>     <span class="keyword">typedef</span> std::vector&lt;std::shared_ptr&lt;AcceptTest&gt; &gt; <a class="code" href="classmcpele_1_1MC.html#ab52ae82dba8e7299583f48a382f8bd5a">accept_t</a>;
<a name="l00087"></a><a class="code" href="classmcpele_1_1MC.html#a025b387c3222c83625323afcddeda1ea">00087</a>     <span class="keyword">typedef</span> std::vector&lt;std::shared_ptr&lt;ConfTest&gt; &gt; <a class="code" href="classmcpele_1_1MC.html#a025b387c3222c83625323afcddeda1ea">conf_t</a>;
<a name="l00088"></a>00088 <span class="keyword">protected</span>:
<a name="l00089"></a><a class="code" href="classmcpele_1_1MC.html#a80e94b003bfc9893c1f829064125a81c">00089</a>     std::shared_ptr&lt;pele::BasePotential&gt; <a class="code" href="classmcpele_1_1MC.html#a80e94b003bfc9893c1f829064125a81c">m_potential</a>;
<a name="l00090"></a><a class="code" href="classmcpele_1_1MC.html#a3a38fa108292b3e7270ad439ebb2c886">00090</a>     <a class="code" href="classpele_1_1Array.html">pele::Array&lt;double&gt;</a> <a class="code" href="classmcpele_1_1MC.html#a3a38fa108292b3e7270ad439ebb2c886">m_coords</a>;
<a name="l00091"></a><a class="code" href="classmcpele_1_1MC.html#ab32722238c16272bf95141b825fd3bf4">00091</a>     <a class="code" href="classpele_1_1Array.html">pele::Array&lt;double&gt;</a> <a class="code" href="classmcpele_1_1MC.html#ab32722238c16272bf95141b825fd3bf4">m_trial_coords</a>;
<a name="l00092"></a><a class="code" href="classmcpele_1_1MC.html#a582e528bae7b630e6845628f49ae443d">00092</a>     <a class="code" href="classmcpele_1_1MC.html#a6b0a924bb76c28b6fc25c66675c1dcf9">actions_t</a> <a class="code" href="classmcpele_1_1MC.html#a582e528bae7b630e6845628f49ae443d">m_actions</a>;
<a name="l00093"></a><a class="code" href="classmcpele_1_1MC.html#aa28a68b36566e4c5e4bb27ae816c37ab">00093</a>     <a class="code" href="classmcpele_1_1MC.html#ab52ae82dba8e7299583f48a382f8bd5a">accept_t</a> <a class="code" href="classmcpele_1_1MC.html#aa28a68b36566e4c5e4bb27ae816c37ab">m_accept_tests</a>;
<a name="l00094"></a><a class="code" href="classmcpele_1_1MC.html#a444f1a159469de77761abced4a94dc48">00094</a>     <a class="code" href="classmcpele_1_1MC.html#a025b387c3222c83625323afcddeda1ea">conf_t</a> <a class="code" href="classmcpele_1_1MC.html#a444f1a159469de77761abced4a94dc48">m_conf_tests</a>;
<a name="l00095"></a><a class="code" href="classmcpele_1_1MC.html#a6910233a8f6223c7826eebacb3f48f6c">00095</a>     <a class="code" href="classmcpele_1_1MC.html#a025b387c3222c83625323afcddeda1ea">conf_t</a> <a class="code" href="classmcpele_1_1MC.html#a6910233a8f6223c7826eebacb3f48f6c">m_late_conf_tests</a>;
<a name="l00096"></a><a class="code" href="classmcpele_1_1MC.html#a3d1e08b4757ebbeab14b523b8cecbc54">00096</a>     std::shared_ptr&lt;TakeStep&gt; <a class="code" href="classmcpele_1_1MC.html#a3d1e08b4757ebbeab14b523b8cecbc54">m_take_step</a>;
<a name="l00097"></a><a class="code" href="classmcpele_1_1MC.html#a1aac8aa817cf8eecd16eb414717b9205">00097</a>     <span class="keywordtype">size_t</span> <a class="code" href="classmcpele_1_1MC.html#a1aac8aa817cf8eecd16eb414717b9205">m_nitercount</a>;
<a name="l00098"></a><a class="code" href="classmcpele_1_1MC.html#a44e3aeb2ee137f98ec748f589da34250">00098</a>     <span class="keywordtype">size_t</span> <a class="code" href="classmcpele_1_1MC.html#a44e3aeb2ee137f98ec748f589da34250">m_accept_count</a>;
<a name="l00099"></a><a class="code" href="classmcpele_1_1MC.html#a98a00b35b659a559433c7f4bba313c34">00099</a>     <span class="keywordtype">size_t</span> <a class="code" href="classmcpele_1_1MC.html#a98a00b35b659a559433c7f4bba313c34">m_E_reject_count</a>;
<a name="l00100"></a><a class="code" href="classmcpele_1_1MC.html#a47bd41b121d3fda1ed69281454edd8c9">00100</a>     <span class="keywordtype">size_t</span> <a class="code" href="classmcpele_1_1MC.html#a47bd41b121d3fda1ed69281454edd8c9">m_conf_reject_count</a>;
<a name="l00101"></a><a class="code" href="classmcpele_1_1MC.html#ad31e9ad1eca13c1826461ceb915bad23">00101</a>     <span class="keywordtype">bool</span> <a class="code" href="classmcpele_1_1MC.html#ad31e9ad1eca13c1826461ceb915bad23">m_success</a>;
<a name="l00102"></a>00102     <span class="comment">/*nitercount is the cumulative count, it does not get reset at the end of run*/</span>
<a name="l00103"></a><a class="code" href="classmcpele_1_1MC.html#adca6168469b1bac463443a81ae8dde05">00103</a>     <span class="keywordtype">bool</span> <a class="code" href="classmcpele_1_1MC.html#adca6168469b1bac463443a81ae8dde05">m_print_progress</a>;
<a name="l00104"></a>00104 <span class="keyword">public</span>:
<a name="l00105"></a>00105     <span class="comment">/*need to keep these public to make them accessible to tests and actions, be careful though!*/</span>
<a name="l00106"></a><a class="code" href="classmcpele_1_1MC.html#a570b47c5f340c2afda0a519f1225eba9">00106</a>     <span class="keywordtype">size_t</span> <a class="code" href="classmcpele_1_1MC.html#a570b47c5f340c2afda0a519f1225eba9">m_niter</a>;
<a name="l00107"></a><a class="code" href="classmcpele_1_1MC.html#a678adb43213ef8da3a8b7620a8ff4d6e">00107</a>     <span class="keywordtype">size_t</span> <a class="code" href="classmcpele_1_1MC.html#a678adb43213ef8da3a8b7620a8ff4d6e">m_neval</a>;
<a name="l00108"></a><a class="code" href="classmcpele_1_1MC.html#ac96652882e0e578172de302578be5b88">00108</a>     <span class="keywordtype">double</span> <a class="code" href="classmcpele_1_1MC.html#ac96652882e0e578172de302578be5b88">m_temperature</a>;
<a name="l00109"></a><a class="code" href="classmcpele_1_1MC.html#a61af4e6db5014d3ab4251dd38aca68f5">00109</a>     <span class="keywordtype">double</span> <a class="code" href="classmcpele_1_1MC.html#a61af4e6db5014d3ab4251dd38aca68f5">m_energy</a>;
<a name="l00110"></a><a class="code" href="classmcpele_1_1MC.html#a956f949abbf2bd055e72924cb136f3e7">00110</a>     <span class="keywordtype">double</span> <a class="code" href="classmcpele_1_1MC.html#a956f949abbf2bd055e72924cb136f3e7">m_trial_energy</a>;
<a name="l00111"></a>00111 <span class="keyword">private</span>:
<a name="l00112"></a>00112     <span class="keywordtype">size_t</span> m_report_steps;
<a name="l00113"></a>00113 <span class="keyword">public</span>:
<a name="l00114"></a>00114     <a class="code" href="classmcpele_1_1MC.html#ae144a06dfc924f7ae63d8b14b95a5f6b">MC</a>(std::shared_ptr&lt;pele::BasePotential&gt; potential, <a class="code" href="classpele_1_1Array.html">pele::Array&lt;double&gt;</a>&amp; coords, <span class="keyword">const</span> <span class="keywordtype">double</span> temperature);
<a name="l00115"></a><a class="code" href="classmcpele_1_1MC.html#a4737173950c8a51437230d5d83163572">00115</a>     <span class="keyword">virtual</span> <a class="code" href="classmcpele_1_1MC.html#a4737173950c8a51437230d5d83163572">~MC</a>() {}
<a name="l00116"></a>00116     <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1MC.html#aa1528423634e13ade3fcefa525c5ed89">one_iteration</a>();
<a name="l00117"></a>00117     <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1MC.html#a746de23c4d9ddad54a1e9da1dd025033">run</a>(<span class="keyword">const</span> <span class="keywordtype">size_t</span> max_iter);
<a name="l00118"></a><a class="code" href="classmcpele_1_1MC.html#ac42e32abd801ea17353fd8fb7b23aea5">00118</a>     <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1MC.html#ac42e32abd801ea17353fd8fb7b23aea5">set_temperature</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> T) { <a class="code" href="classmcpele_1_1MC.html#ac96652882e0e578172de302578be5b88">m_temperature</a> = T; }
<a name="l00119"></a><a class="code" href="classmcpele_1_1MC.html#a897efd5c7a2d444811de516f740c1045">00119</a>     <span class="keywordtype">double</span> <a class="code" href="classmcpele_1_1MC.html#a897efd5c7a2d444811de516f740c1045">get_temperature</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classmcpele_1_1MC.html#ac96652882e0e578172de302578be5b88">m_temperature</a>; }
<a name="l00120"></a><a class="code" href="classmcpele_1_1MC.html#a8e7f1ab57cb3d68032c0293b09596d33">00120</a>     <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1MC.html#a8e7f1ab57cb3d68032c0293b09596d33">set_report_steps</a>(<span class="keyword">const</span> <span class="keywordtype">size_t</span> report_steps) { m_report_steps = report_steps; }
<a name="l00121"></a><a class="code" href="classmcpele_1_1MC.html#ac7c99322af8dc258272c3f83c1ba44d3">00121</a>     <span class="keywordtype">size_t</span> <a class="code" href="classmcpele_1_1MC.html#ac7c99322af8dc258272c3f83c1ba44d3">get_report_steps</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_report_steps; }
<a name="l00122"></a><a class="code" href="classmcpele_1_1MC.html#a1f490ace67644e07548ccc7a2781963f">00122</a>     <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1MC.html#a1f490ace67644e07548ccc7a2781963f">add_action</a>(std::shared_ptr&lt;Action&gt; action) { <a class="code" href="classmcpele_1_1MC.html#a582e528bae7b630e6845628f49ae443d">m_actions</a>.push_back(action); }
<a name="l00123"></a><a class="code" href="classmcpele_1_1MC.html#a66f76a288eb6389d408792c8c21c1ff0">00123</a>     <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1MC.html#a66f76a288eb6389d408792c8c21c1ff0">add_accept_test</a>(std::shared_ptr&lt;AcceptTest&gt; accept_test) { <a class="code" href="classmcpele_1_1MC.html#aa28a68b36566e4c5e4bb27ae816c37ab">m_accept_tests</a>.push_back(accept_test); }
<a name="l00124"></a><a class="code" href="classmcpele_1_1MC.html#a326495f91244c8c6761b1d783019a5c6">00124</a>     <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1MC.html#a326495f91244c8c6761b1d783019a5c6">add_conf_test</a>(std::shared_ptr&lt;ConfTest&gt; conf_test) { <a class="code" href="classmcpele_1_1MC.html#a444f1a159469de77761abced4a94dc48">m_conf_tests</a>.push_back(conf_test); }
<a name="l00125"></a><a class="code" href="classmcpele_1_1MC.html#a7a9ab41eb342247e9bacea30c2b3e033">00125</a>     <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1MC.html#a7a9ab41eb342247e9bacea30c2b3e033">add_late_conf_test</a>(std::shared_ptr&lt;ConfTest&gt; conf_test) { <a class="code" href="classmcpele_1_1MC.html#a6910233a8f6223c7826eebacb3f48f6c">m_late_conf_tests</a>.push_back(conf_test); }
<a name="l00126"></a><a class="code" href="classmcpele_1_1MC.html#a4a348d7cb35617b70f8ef2955712b084">00126</a>     <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1MC.html#a4a348d7cb35617b70f8ef2955712b084">set_takestep</a>(std::shared_ptr&lt;TakeStep&gt; takestep) { <a class="code" href="classmcpele_1_1MC.html#a3d1e08b4757ebbeab14b523b8cecbc54">m_take_step</a> = takestep; }
<a name="l00127"></a><a class="code" href="classmcpele_1_1MC.html#aa5207841480b9a6d11699babf63aa95e">00127</a>     std::shared_ptr&lt;TakeStep&gt; <a class="code" href="classmcpele_1_1MC.html#aa5207841480b9a6d11699babf63aa95e">get_takestep</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classmcpele_1_1MC.html#a3d1e08b4757ebbeab14b523b8cecbc54">m_take_step</a>; }
<a name="l00128"></a>00128     <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1MC.html#a5df3e0f95cbe02e4e7ee2e3bb7654dff">set_coordinates</a>(<a class="code" href="classpele_1_1Array.html">pele::Array&lt;double&gt;</a>&amp; coords, <span class="keywordtype">double</span> energy);
<a name="l00129"></a><a class="code" href="classmcpele_1_1MC.html#ac538a56ea555f102fc4fe347f9ff40c3">00129</a>     <span class="keywordtype">double</span> <a class="code" href="classmcpele_1_1MC.html#ac538a56ea555f102fc4fe347f9ff40c3">get_energy</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classmcpele_1_1MC.html#a61af4e6db5014d3ab4251dd38aca68f5">m_energy</a>; }
<a name="l00130"></a>00130     <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1MC.html#ad3ec3d5ae30a44ed5a7f832a1c570b63">reset_energy</a>();
<a name="l00131"></a><a class="code" href="classmcpele_1_1MC.html#a67f441e23995e82288fd9e44072c8efe">00131</a>     <span class="keywordtype">double</span> <a class="code" href="classmcpele_1_1MC.html#a67f441e23995e82288fd9e44072c8efe">get_trial_energy</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classmcpele_1_1MC.html#a956f949abbf2bd055e72924cb136f3e7">m_trial_energy</a>; }
<a name="l00132"></a><a class="code" href="classmcpele_1_1MC.html#a37869df5487d535a9a4515492cd7a056">00132</a>     <a class="code" href="classpele_1_1Array.html">pele::Array&lt;double&gt;</a> <a class="code" href="classmcpele_1_1MC.html#a37869df5487d535a9a4515492cd7a056">get_coords</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classmcpele_1_1MC.html#a3a38fa108292b3e7270ad439ebb2c886">m_coords</a>.<a class="code" href="classpele_1_1Array.html#a84d76eec1543ec958470156674ba9259">copy</a>(); }
<a name="l00133"></a><a class="code" href="classmcpele_1_1MC.html#a1ba8a6e2d26b1124fa4707ad7397a024">00133</a>     <a class="code" href="classpele_1_1Array.html">pele::Array&lt;double&gt;</a> <a class="code" href="classmcpele_1_1MC.html#a1ba8a6e2d26b1124fa4707ad7397a024">get_trial_coords</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classmcpele_1_1MC.html#ab32722238c16272bf95141b825fd3bf4">m_trial_coords</a>.<a class="code" href="classpele_1_1Array.html#a84d76eec1543ec958470156674ba9259">copy</a>(); }
<a name="l00134"></a><a class="code" href="classmcpele_1_1MC.html#a61bb33c1cfd7e7f1caa96ae9f9af79f1">00134</a>     <span class="keywordtype">double</span> <a class="code" href="classmcpele_1_1MC.html#a61bb33c1cfd7e7f1caa96ae9f9af79f1">get_norm_coords</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> norm(<a class="code" href="classmcpele_1_1MC.html#a3a38fa108292b3e7270ad439ebb2c886">m_coords</a>); }
<a name="l00135"></a><a class="code" href="classmcpele_1_1MC.html#a6a2355df19783573a6d15294cce4fd43">00135</a>     <span class="keywordtype">size_t</span> <a class="code" href="classmcpele_1_1MC.html#a6a2355df19783573a6d15294cce4fd43">get_naccept</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classmcpele_1_1MC.html#a44e3aeb2ee137f98ec748f589da34250">m_accept_count</a>; }
<a name="l00136"></a><a class="code" href="classmcpele_1_1MC.html#a5c9f22a57a3e9cc0228c7f84acd8ec7f">00136</a>     <span class="keywordtype">size_t</span> <a class="code" href="classmcpele_1_1MC.html#a5c9f22a57a3e9cc0228c7f84acd8ec7f">get_nreject</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classmcpele_1_1MC.html#a1aac8aa817cf8eecd16eb414717b9205">m_nitercount</a> - <a class="code" href="classmcpele_1_1MC.html#a44e3aeb2ee137f98ec748f589da34250">m_accept_count</a>; }
<a name="l00137"></a><a class="code" href="classmcpele_1_1MC.html#a5a2cf1de51e632cd845002299f6d2e9f">00137</a>     <span class="keywordtype">double</span> <a class="code" href="classmcpele_1_1MC.html#a5a2cf1de51e632cd845002299f6d2e9f">get_accepted_fraction</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code" href="classmcpele_1_1MC.html#a44e3aeb2ee137f98ec748f589da34250">m_accept_count</a>) /
<a name="l00138"></a>00138             static_cast&lt;double&gt;(<a class="code" href="classmcpele_1_1MC.html#a1aac8aa817cf8eecd16eb414717b9205">m_nitercount</a>); }
<a name="l00139"></a><a class="code" href="classmcpele_1_1MC.html#a83bfebc60ee7a0db945aeeeaede84181">00139</a>     <span class="keywordtype">double</span> <a class="code" href="classmcpele_1_1MC.html#a83bfebc60ee7a0db945aeeeaede84181">get_conf_rejection_fraction</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code" href="classmcpele_1_1MC.html#a47bd41b121d3fda1ed69281454edd8c9">m_conf_reject_count</a>) /
<a name="l00140"></a>00140             static_cast&lt;double&gt;(<a class="code" href="classmcpele_1_1MC.html#a1aac8aa817cf8eecd16eb414717b9205">m_nitercount</a>); }
<a name="l00141"></a><a class="code" href="classmcpele_1_1MC.html#acfb4b64a6a339518c2a12a30b5f6b069">00141</a>     <span class="keywordtype">double</span> <a class="code" href="classmcpele_1_1MC.html#acfb4b64a6a339518c2a12a30b5f6b069">get_E_rejection_fraction</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code" href="classmcpele_1_1MC.html#a98a00b35b659a559433c7f4bba313c34">m_E_reject_count</a>) /
<a name="l00142"></a>00142             static_cast&lt;double&gt;(<a class="code" href="classmcpele_1_1MC.html#a1aac8aa817cf8eecd16eb414717b9205">m_nitercount</a>); }
<a name="l00143"></a><a class="code" href="classmcpele_1_1MC.html#a9a8e8b2c4a9e77b5136c9a3c1b67bb9c">00143</a>     <span class="keywordtype">size_t</span> <a class="code" href="classmcpele_1_1MC.html#a9a8e8b2c4a9e77b5136c9a3c1b67bb9c">get_iterations_count</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classmcpele_1_1MC.html#a1aac8aa817cf8eecd16eb414717b9205">m_nitercount</a>; }
<a name="l00144"></a><a class="code" href="classmcpele_1_1MC.html#a656ec94034cc412e819438d21f7fcfa3">00144</a>     <span class="keywordtype">size_t</span> <a class="code" href="classmcpele_1_1MC.html#a656ec94034cc412e819438d21f7fcfa3">get_neval</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classmcpele_1_1MC.html#a678adb43213ef8da3a8b7620a8ff4d6e">m_neval</a>; }
<a name="l00145"></a><a class="code" href="classmcpele_1_1MC.html#a1e0731055ab95e94142cd0c20fce2daf">00145</a>     std::shared_ptr&lt;pele::BasePotential&gt; <a class="code" href="classmcpele_1_1MC.html#a1e0731055ab95e94142cd0c20fce2daf">get_potential_ptr</a>() { <span class="keywordflow">return</span> <a class="code" href="classmcpele_1_1MC.html#a80e94b003bfc9893c1f829064125a81c">m_potential</a>; }
<a name="l00146"></a><a class="code" href="classmcpele_1_1MC.html#af0c4c8dcf99b125917644ee5744d4ed6">00146</a>     <span class="keywordtype">bool</span> <a class="code" href="classmcpele_1_1MC.html#af0c4c8dcf99b125917644ee5744d4ed6">take_step_specified</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classmcpele_1_1MC.html#a3d1e08b4757ebbeab14b523b8cecbc54">m_take_step</a> != NULL; }
<a name="l00147"></a><a class="code" href="classmcpele_1_1MC.html#aa822dbcc2c5e3d2489880c5f16cb1dfd">00147</a>     <span class="keywordtype">bool</span> <a class="code" href="classmcpele_1_1MC.html#aa822dbcc2c5e3d2489880c5f16cb1dfd">report_steps_specified</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classmcpele_1_1MC.html#ac7c99322af8dc258272c3f83c1ba44d3">get_report_steps</a>() &gt; 0; }
<a name="l00148"></a>00148     <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1MC.html#a3682931dc32796af0c7051ce3311c54f">check_input</a>();
<a name="l00149"></a><a class="code" href="classmcpele_1_1MC.html#ab16a83837236952cac564a9f319ea7a1">00149</a>     <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1MC.html#ab16a83837236952cac564a9f319ea7a1">set_print_progress</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span> input) { <a class="code" href="classmcpele_1_1MC.html#adca6168469b1bac463443a81ae8dde05">m_print_progress</a> = input; }
<a name="l00150"></a><a class="code" href="classmcpele_1_1MC.html#a071420a97e409024070d9c4580f8fe51">00150</a>     <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1MC.html#a071420a97e409024070d9c4580f8fe51">set_print_progress</a>() { <a class="code" href="classmcpele_1_1MC.html#a071420a97e409024070d9c4580f8fe51">set_print_progress</a>(<span class="keyword">true</span>); }
<a name="l00151"></a><a class="code" href="classmcpele_1_1MC.html#a18448513c2ed188169f3e26a3c431300">00151</a>     <span class="keywordtype">bool</span> <a class="code" href="classmcpele_1_1MC.html#a18448513c2ed188169f3e26a3c431300">get_success</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classmcpele_1_1MC.html#ad31e9ad1eca13c1826461ceb915bad23">m_success</a>; }
<a name="l00155"></a><a class="code" href="classmcpele_1_1MC.html#a9277bffe822241e2138dd1de6db320f4">00155</a>     <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1MC.html#a9277bffe822241e2138dd1de6db320f4">abort</a>() { <a class="code" href="classmcpele_1_1MC.html#a570b47c5f340c2afda0a519f1225eba9">m_niter</a> = std::numeric_limits&lt;size_t&gt;::max(); }
<a name="l00156"></a>00156 <span class="keyword">protected</span>:
<a name="l00157"></a><a class="code" href="classmcpele_1_1MC.html#ab0a769e799bccd46f1e290daf1f4698b">00157</a>     <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classmcpele_1_1MC.html#ab0a769e799bccd46f1e290daf1f4698b">compute_energy</a>(<a class="code" href="classpele_1_1Array.html">pele::Array&lt;double&gt;</a> x)
<a name="l00158"></a>00158     {
<a name="l00159"></a>00159         ++<a class="code" href="classmcpele_1_1MC.html#a678adb43213ef8da3a8b7620a8ff4d6e">m_neval</a>;
<a name="l00160"></a>00160         <span class="keywordflow">return</span> <a class="code" href="classmcpele_1_1MC.html#a80e94b003bfc9893c1f829064125a81c">m_potential</a>-&gt;get_energy(x);
<a name="l00161"></a>00161     }
<a name="l00162"></a>00162     <span class="keywordtype">bool</span> <a class="code" href="classmcpele_1_1MC.html#a10c67bdbd29525b7cfe4c97f861e5b8f">do_conf_tests</a>(<a class="code" href="classpele_1_1Array.html">pele::Array&lt;double&gt;</a> x);
<a name="l00163"></a>00163     <span class="keywordtype">bool</span> <a class="code" href="classmcpele_1_1MC.html#ab122e2f3a32b409493043d62a2ad5806">do_accept_tests</a>(<a class="code" href="classpele_1_1Array.html">pele::Array&lt;double&gt;</a> xtrial, <span class="keywordtype">double</span> etrial, <a class="code" href="classpele_1_1Array.html">pele::Array&lt;double&gt;</a> xold, <span class="keywordtype">double</span> eold);
<a name="l00164"></a>00164     <span class="keywordtype">bool</span> <a class="code" href="classmcpele_1_1MC.html#ac2f9ac6eaf22fff6d85e3a659658c3c2">do_late_conf_tests</a>(<a class="code" href="classpele_1_1Array.html">pele::Array&lt;double&gt;</a> x);
<a name="l00165"></a>00165     <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1MC.html#afc4426d60374b2d941405d269eb214ed">do_actions</a>(<a class="code" href="classpele_1_1Array.html">pele::Array&lt;double&gt;</a> x, <span class="keywordtype">double</span> energy, <span class="keywordtype">bool</span> success);
<a name="l00166"></a>00166     <span class="keywordtype">void</span> <a class="code" href="classmcpele_1_1MC.html#ac9f211c253a12cd3e6bed935a0c8c1f2">take_steps</a>();
<a name="l00167"></a>00167 };
<a name="l00168"></a>00168 
<a name="l00169"></a>00169 }<span class="comment">//namespace mcpele</span>
<a name="l00170"></a>00170 
<a name="l00171"></a>00171 <span class="preprocessor">#endif//#ifndef _MCPELE_MC_H</span>
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Thu Dec 11 2014 10:19:44 for mcpele by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
